(this.webpackJsonpdoor_opener_react=this.webpackJsonpdoor_opener_react||[]).push([[0],{49:function(e,t,n){},56:function(e,t,n){},58:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),o=n(27),r=n.n(o),s=(n(49),n(34)),i=n(26),u=n(3),l=n(15),b=(n(40),n(56),n(36)),j=n(4),d=n.n(j),p=n(9),O=n(5),f=n(44),v=n(38),h=n.p+"static/media/remote.7c35736d.png",g=(n(58),n(7));function x(){var e,t,n=Object(a.useState)(1),c=Object(O.a)(n,2),o=c[0],r=c[1],i=Object(a.useState)(!1),j=Object(O.a)(i,2),x=j[0],m=j[1],C=null!==(e=localStorage.getItem("key"))&&void 0!==e?e:null,S=null!==(t=localStorage.getItem("user"))&&void 0!==t?t:null,y=Object(f.useGeolocated)({positionOptions:{enableHighAccuracy:!1},userDecisionTimeout:1e4}),k=y.coords,M=y.isGeolocationEnabled;Object(a.useEffect)((function(){if(M&&k){(function(e,t,n,a){var c=function(e){return e*(Math.PI/180)},o=c(n-e),r=c(a-t),s=Math.sin(o/2)*Math.sin(o/2)+Math.cos(c(e))*Math.cos(c(n))*Math.sin(r/2)*Math.sin(r/2);return 2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s))*6371})(Number("39.07333869546294"),Number("-3.620745524096387"),k.latitude,k.longitude)>.5&&l.b.warn("Cuidado! est\xe1s alejado/a de casa para abrir la puerta",{autoClose:2e3})}}),[k,M]);var I=function(){var e=Object(p.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!x){e.next=2;break}return e.abrupt("return");case 2:return m(!0),r(.2),l.b.info("Abriendo puerta... ",{autoClose:2e3}),e.prev=5,e.next=8,s.a.post("https://openfbc.davidsantiago.net",{key:C,user:S,lng:null===k||void 0===k?void 0:k.longitude,lat:null===k||void 0===k?void 0:k.latitude});case 8:l.b.success("Puerta abierta, bienvenido/a a casa ".concat(S),{autoClose:2e3}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),401===(null===(t=e.t0.response)||void 0===t?void 0:t.status)?l.b.error("No autorizado",{autoClose:2e3}):l.b.error("Error de comunicaci\xf3n: ".concat(e.t0),{autoClose:2e3});case 14:return e.prev=14,r(1),m(!1),e.finish(14);case 18:case"end":return e.stop()}}),e,null,[[5,11,14,18]])})));return function(){return e.apply(this,arguments)}}(),N=Object(u.l)(),E=Object(v.useDoubleTap)(I),w=Object(v.useDoubleTap)((function(){localStorage.clear(),l.b.success("Credenciales reseteadas",{autoClose:2e3}),N("/")}));return Object(g.jsxs)("div",{children:[Object(g.jsx)("img",Object(b.a)({src:h,className:"button",alt:"Abrir",style:{opacity:o}},E)),Object(g.jsx)("br",{}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{}),Object(g.jsx)("div",Object(b.a)(Object(b.a)({className:"version"},w),{},{children:"1.4.1"}))]})}n(66);function m(){var e,t=Object(a.useState)(""),n=Object(O.a)(t,2),c=n[0],o=n[1],r=Object(a.useState)(""),s=Object(O.a)(r,2),i=s[0],l=s[1],b=Object(u.l)(),j=null!==(e=localStorage.getItem("key"))&&void 0!==e?e:null;return Object(g.jsxs)("div",{className:"form",children:[j&&Object(g.jsx)(u.a,{to:"/button"}),Object(g.jsx)("input",{type:"text",id:"user",placeholder:"Nombre",onChange:function(e){return l(e.target.value)}}),Object(g.jsx)("br",{}),Object(g.jsx)("input",{type:"text",id:"key",placeholder:"Llave",onChange:function(e){return o(e.target.value)}}),Object(g.jsx)("br",{}),Object(g.jsx)("button",{id:"btn-send",onClick:function(){c&&""!==c&&i&&""!==i&&(localStorage.setItem("key",c),localStorage.setItem("user",i),b("/button"))},children:"Enviar"})]})}var C=function(){console.log("version","1.4.1"),console.log("https://openfbc.davidsantiago.net"),Object(a.useEffect)((function(){s.a.get("https://openfbc.davidsantiago.net").then((function(){l.b.success("Servicio preparado",{autoClose:2e3})})).catch((function(e){l.b.error("Error de comunicaci\xf3n: ".concat(e),{autoClose:2e3})}))}),[]);var e=Object(i.a)([{path:"/",element:Object(g.jsx)(m,{})},{path:"/button",element:Object(g.jsx)(x,{})}]);return Object(g.jsxs)("div",{className:"App",children:[Object(g.jsx)(u.c,{router:e}),Object(g.jsx)(l.a,{newestOnTop:!0})]})},S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,68)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),o(e),r(e)}))};r.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(C,{})}),document.getElementById("root")),S()}},[[67,1,2]]]);
//# sourceMappingURL=main.55f10d82.chunk.js.map