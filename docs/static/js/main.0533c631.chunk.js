(this.webpackJsonpdoor_opener_react=this.webpackJsonpdoor_opener_react||[]).push([[0],{37:function(e,t,n){},38:function(e,t,n){},40:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),c=n(14),r=n.n(c),s=(n(37),n(4)),i=(n(38),n(32)),u=n(23),l=n.n(u),b=n(26),d=n.p+"static/media/remote.7c35736d.png",j=(n(40),n(7)),p=(n(25),n(27)),v=n(20),f=n(31),h=n(3);function O(){var e,t,n=Object(a.useState)(1),o=Object(s.a)(n,2),c=o[0],r=o[1],u=Object(a.useState)(!1),O=Object(s.a)(u,2),g=O[0],m=O[1],x=null!==(e=localStorage.getItem("key"))&&void 0!==e?e:null,C=null!==(t=localStorage.getItem("user"))&&void 0!==t?t:null,S=Object(f.useGeolocated)({positionOptions:{enableHighAccuracy:!1},userDecisionTimeout:1e4}),k=S.coords,y=S.isGeolocationEnabled;Object(a.useEffect)((function(){if(y&&k){(function(e,t,n,a){var o=function(e){return e*(Math.PI/180)},c=o(n-e),r=o(a-t),s=Math.sin(c/2)*Math.sin(c/2)+Math.cos(o(e))*Math.cos(o(n))*Math.sin(r/2)*Math.sin(r/2);return 2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s))*6371})(Number("39.07333869546294"),Number("-3.620745524096387"),k.latitude,k.longitude)>.5&&j.b.warn("Cuidado! est\xe1s alejado/a de casa para abrir la puerta",{autoClose:2e3})}}),[k,y]);var M=function(){var e=Object(b.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!g){e.next=2;break}return e.abrupt("return");case 2:return m(!0),r(.2),j.b.info("Abriendo puerta... ",{autoClose:2e3}),e.prev=5,e.next=8,v.a.post("https://openfbc.davidsantiago.net",{key:x,user:C,lng:null===k||void 0===k?void 0:k.longitude,lat:null===k||void 0===k?void 0:k.latitude});case 8:j.b.success("Puerta abierta, bienvenido/a a casa ".concat(C),{autoClose:2e3}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),401===(null===(t=e.t0.response)||void 0===t?void 0:t.status)?j.b.error("No autorizado",{autoClose:2e3}):j.b.error("Error de comunicaci\xf3n: ".concat(e.t0),{autoClose:2e3});case 14:return e.prev=14,r(1),m(!1),e.finish(14);case 18:case"end":return e.stop()}}),e,null,[[5,11,14,18]])})));return function(){return e.apply(this,arguments)}}(),I=Object(p.useDoubleTap)(M);return Object(h.jsx)("div",{children:Object(h.jsx)("img",Object(i.a)({src:d,className:"button",alt:"Abrir",style:{opacity:c}},I))})}var g=n(12);n(54);function m(){var e=Object(a.useState)(""),t=Object(s.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(""),r=Object(s.a)(c,2),i=r[0],u=r[1],l=Object(g.b)(),b=Object(s.a)(l,2),d=(b[0],b[1]);return Object(h.jsxs)("div",{className:"form",children:[Object(h.jsx)("input",{type:"text",id:"user",placeholder:"Nombre",onChange:function(e){return u(e.target.value)}}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"text",id:"key",placeholder:"Llave",onChange:function(e){return o(e.target.value)}}),Object(h.jsx)("br",{}),Object(h.jsx)("button",{id:"btn-send",onClick:function(){n&&""!==n&&i&&""!==i&&(localStorage.setItem("key",n),localStorage.setItem("user",i),d("/button"))},children:"Enviar"})]})}var x=function(){var e,t="1.4.0";console.log("version",t);var n=null!==(e=localStorage.getItem("key"))&&void 0!==e?e:null,o=Object(g.b)(),c=Object(s.a)(o,2),r=(c[0],c[1]);return console.log("https://openfbc.davidsantiago.net"),Object(a.useEffect)((function(){v.a.get("https://openfbc.davidsantiago.net").then((function(){j.b.success("Servicio preparado",{autoClose:2e3})})).catch((function(e){j.b.error("Error de comunicaci\xf3n: ".concat(e),{autoClose:2e3})}))}),[]),n&&r("/button"),Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(g.a,{component:m,path:"/"}),Object(h.jsx)(g.a,{component:O,path:"/button"}),Object(h.jsx)("br",{}),Object(h.jsx)("br",{}),Object(h.jsx)("div",{className:"version",onClick:function(){localStorage.clear(),j.b.success("Credenciales reseteadas",{autoClose:2e3}),r("/")},children:t}),Object(h.jsx)(j.a,{newestOnTop:!0})]})},C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,56)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),o(e),c(e),r(e)}))};r.a.render(Object(h.jsx)(o.a.StrictMode,{children:Object(h.jsx)(x,{})}),document.getElementById("root")),C()}},[[55,1,2]]]);
//# sourceMappingURL=main.0533c631.chunk.js.map